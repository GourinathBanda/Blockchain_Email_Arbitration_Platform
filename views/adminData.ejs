<!DOCTYPE html>
<html>
<head>
	<title>Welcome</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">
	</script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="./css/main.css">



  <script type="text/javascript">
  var x ;
	$( "#form" ).submit(function(event){
		event.preventDefault();
		print(x);
		$.ajax({
			type: 'POST',
			url: '/profile',
			data: {"uniqueMailId" : x},
			dataType: "json",
			success: function(response){
				//alert("a");
				//console.log(response.Success);
				$('#form')[0].reset();
				
				document.getElementById("check").innerHTML=response.Success;
					// ADD THIS CODE
					setTimeout(function(){
						document.getElementById("check").innerHTML="";
					},3000);
					if (response.Success=="Success!") {
							// if(response.userType == "generalUser")
							// 	document.getElementById("generalUserType").click();
							// else if(response.userType == "admin")
							// 	document.getElementById("adminType").click();
					};
			},
				error: function() {
					
				}
			});
	});


      function show() {
			  var rowId = event.target.parentNode.parentNode.id;
			  var data = document.getElementById(rowId);
              var row_data = data.getElementsByTagName('td');
			  console.log(rowId);
			  var unique_id = row_data[1].innerHTML;
			  console.log(unique_id);
			  x = unique_id;
			  $("#uniqueMailId").value = "hi";
			  $("#form").submit();

            //   var data = document.getElementById(rowId);
            //   var row_data = data.getElementsByTagName('td');
            //   // var rowSelected = table.getElementsByTagName('td')[rowId];
            //   var unique_id = row_data[1].innerHTML;
            //   var messageId = row_data[2].innerHTML;
            //   var timeStamp = row_data[3].innerHTML;

            //   console.log(unique_id);
    
            //   var x = document.getElementById("waiting"+rowId);
			// 	console.log(x);
            //   x.style.display = "block";

            //   var y = document.getElementById("submitButton"+rowId);
			// 	console.log(x);
            //   y.style.display = "hidden";
            }
	</script>

</head>
<body>
	<div class="col-md-6 col-md-offset-5">
	<div style='float: right;' >
		<a href="/logout">Logout</a>
	</div>
</div>
	<div class="col-md-4 col-md-offset-4">
		<div>
			<p>Profile Detail</p>
		</div>
		<div>
			<center>
				<table class="table table-hover text-center">
					<tr><td>Name </td><td><%= name %></td></tr>
					<tr><td>Email </td><td><%= email %></td></tr>
				</table>
			</center>
			<div class="col-md-8 col-md-offset-3">
				<br>
				<a href="/addJudiciary">
					<div>
						<p>Add Judiciary</p>
					</div>
				</a>
				<a href="/removeJudiciary">
					<div>
						<p>Remove Judiciary</p>
					</div>
				</a>
			</br><br><br>
			</div>

			<!-- <div class="findMyEmail">
				<a href="/findMyEmail"><h4>Find my email</h4></a>
			</div> -->
			<div class="col-md-4 col-md-offset-4">
				<h4>Email Requests</h4>
			</div>
		</div>

	</div>
	<div class="col-md-0 col-md-offset-2">
	<div style="height:200px; overflow-y: scroll;width:800px;">
		<center>
		<table id = "email" class="table table-hover text-center" >
			<thead>
  				<th><center>S.No</center></th>
				<th><center>Unique Mail Id</center></th>
				<th><center>User Id</center></th>
  				<th><center>Message Id</center></th>
  				<th><center>Email Time Stamp</center></th>
  				<th><center>Request Time</center></th>
  				<th><center>Status</center></th>
			</thead>
      <tbody>
          <% for(var i=0; i < emailRequestData.length; i++) { %>
    		<tr id= <%= i+1 %> >
    		<td><%= i+1 %></td>
			<td class="row-data"><%= emailRequestData[i].uniqueMailId %></td>
			<td class="row-data"><%= emailRequestData[i].userId %></td>
			<td class="row-data"><%= emailRequestData[i].messageId %></td>
			<td class="row-data"><%= emailRequestData[i].emailTimeStamp %></td>
			<td class="row-data"><%= emailRequestData[i].currTimeStamp %></td>
    		<td>
			<% if(emailRequestData[i].status==="Pending"){ %>
			<a href="/searchMail/<%= emailRequestData[i].uniqueMailId %>">Search</a>
			<%} else{ %>
			<%= emailRequestData[i].status %>
			<% } %>
    		<i id="waiting<%= i+1 %>" hidden>waiting for judiciary details...</i>
            </td>
    		</tr>
			<% } %>
				
				
      </tbody>

	</table>
	<!-- <form id="form" method="post" >
		<input id="uniqueMailId" type="text" name="uniqueMailId" placeholder="" class="form-control"><br/>
		<input type="submit" value="search" class="btn btn-success">
	</form> -->
			
		</center>
		<!-- <span><%= emailRequestData %></span> -->
	</div>
	<p id="check"></p>
</div>

</body>
</html>